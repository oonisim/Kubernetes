#--------------------------------------------------------------------------------
# Datadog installation.
# Make dd-agent can access K8S certificate files for client auth, etc.
#--------------------------------------------------------------------------------
- include: "{{ ansible_distribution }}_{{ ansible_distribution_major_version}}.yml"
- name: "dd-agent in {{ K8S_GROUP }} to access K8S file e.g certificates"
  user:
    name:     "dd-agent"
    groups:   "{{ K8S_GROUP }}"
    append:   "yes"                 # useradd -aG


#--------------------------------------------------------------------------------
# Make sure dd-agent user can access K8S client certificates for K8S checks.
# This has been done in K8S installation module but to be sure.
#--------------------------------------------------------------------------------
- name: "Change group of the K8S configurations"
  file:
    path:     "{{ K8S_CONFIG_HOME }}"
    state:    "directory"
    group:    "{{ K8S_GROUP }}"
    mode:     "0650"
    recurse:  true